steps:
  - name: maven:3-openjdk-11
    entrypoint: mvn
    args: ['install', '-DskipTests', '--batch-mode']

  - name: maven:3-openjdk-11
    entrypoint: mvn
    args: [
        'verify',
        '-f',
        'google-cloud-spanner-hibernate-samples/pom.xml',
        '-Dhibernate.connection.url=$_JDBC_URL',
        '-Dspring.datasource.url=$_JDBC_URL',
        '-Dquarkus.datasource.jdbc.url=$_JDBC_URL'
    ]

timeout: 120m

options:
  volumes:
    - name: 'm2-cache'
      path: /root/.m2

substitutions:
  _JDBC_URL: 'jdbc:cloudspanner:/projects/cloud-spanner-hibernate-ci/instances/test-instance/databases/hibernate-sample-db'